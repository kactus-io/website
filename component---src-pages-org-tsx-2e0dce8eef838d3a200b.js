(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"2kwh":function(e,t,n){},"8PO/":function(e,t,n){"use strict";n.r(t);var r=n("wx14"),a=n("q1tI"),o=n.n(a),c=n("Wbzz"),i=n("9Dj+"),l=n("H8eV"),u=n("BNza"),s=n("mtTv"),b=n("0cdV"),m=(n("2kwh"),n("qKvR")),O=function(e){var t=e.setUser;return Object(m.a)("button",{className:"cta logout",onClick:function(){return t(null)}},"Logout")},g=n("86Pe"),d=n("rePB");function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){var t=e.user,n=e.setUser;return Object(m.a)("div",{className:"centered-section"},Object(m.a)("em",null,"You are part of multiple organizations."),Object(m.a)("ul",null,t.orgs.map((function(e){return Object(m.a)("li",{key:e.id,onClick:function(){n(p(p({},t),{},{currentOrg:e}))}},e.id," - ",e.members.length," members")}))))},f=function(e){var t=e.user,n=e.org,r=e.setBanner,a=e.setUser,c=o.a.useState("enterprise"),i=c[0],l=c[1],u=o.a.useState("month"),s=u[0],b=u[1];return Object(m.a)("div",{id:"create-org",className:"centered-section"},n?null:Object(m.a)("div",null,Object(m.a)("p",null,Object(m.a)("em",null,"You do not have any organization yet.")),Object(m.a)("p",null,"An organization allows you to centralize the licenses for the designers in your team.")),Object(m.a)("div",{className:"features"},Object(m.a)("div",{className:"premium"===i?"plan selected":"plan",onClick:function(){return l("premium")}},Object(m.a)("h2",null,"Premium"),Object(m.a)("h3",null,"$4.99"),Object(m.a)("h4",null,"per user per month"),Object(m.a)("ul",null,Object(m.a)("li",null,"Unlimited public repositories"),Object(m.a)("li",null,"No locked-in commitment: you can always generate the sketch files to switch back"),Object(m.a)("li",null,Object(m.a)("strong",null,"Unlimited private repositories")))),Object(m.a)("div",{className:"enterprise"===i?"plan selected":"plan",onClick:function(){return l("enterprise")}},Object(m.a)("h2",null,"Enterprise"),Object(m.a)("h3",null,"$11.99"),Object(m.a)("h4",null,"per user per month"),Object(m.a)("ul",null,Object(m.a)("li",null,"Unlimited public repositories"),Object(m.a)("li",null,"No locked-in commitment: you can always generate the sketch files to switch back"),Object(m.a)("li",null,Object(m.a)("strong",null,"Unlimited private repositories")),Object(m.a)("li",null,Object(m.a)("strong",null,"Support single sign-on and on-premises deployment")),Object(m.a)("li",null,Object(m.a)("strong",null,"Support any git server (BitBucket, Gitlab, self-hosted, etc.)"))))),Object(m.a)("div",{className:"billing-duration-wrapper"},Object(m.a)("p",null,Object(m.a)("label",{htmlFor:"monthly-billing"},Object(m.a)("input",{type:"radio",value:"month",id:"monthly-billing",name:"duration-billing",checked:"month"===s,onChange:function(e){return b("month"===e.currentTarget.value?"month":"year")}}),"Monthly billing",Object(m.a)("span",{className:"billing-quote"},"enterprise"===i?"$11.99 / month":"$4.99 / month"))),Object(m.a)("p",null,Object(m.a)("label",{htmlFor:"yearly-billing"},Object(m.a)("input",{type:"radio",value:"year",id:"yearly-billing",name:"duration-billing",checked:"year"===s,onChange:function(e){return b("month"===e.currentTarget.value?"month":"year")}}),"Yearly billing",Object(m.a)("span",{id:"yearly-billing-quote",className:"billing-quote"},"enterprise"===i?"$119.90 / year (2 months free)":"$49.90 / year (2 months free)")))),Object(m.a)(g.b,{setUser:a,setBanner:r,primary:!0,enterprise:"enterprise"===i,duration:s,user:t,ctaLabel:n?"Unlock Organization":"Create an Organization",org:n}))},y=n("i8i4"),v=n.n(y),k=(n("CE1Z"),function(e){var t=e.children,n=o.a.useRef(document.createElement("div"));return o.a.useEffect((function(){return document.body.appendChild(n.current),function(){return document.body.removeChild(n.current)}}),[]),v.a.createPortal(t,n.current)}),w=function(e){e.user,e.org,e.setBanner,e.setUser;var t=e.onRedirectToStripeDashboard,n=o.a.useRef(null),r=o.a.useState(!1),a=r[0],c=r[1];return Object(m.a)(o.a.Fragment,null,Object(m.a)("button",{className:"settings-trigger",ref:n,onClick:function(){return c(!0)}},"⚙️"),a?Object(m.a)(k,null,Object(m.a)("div",{className:"overlay",onClick:function(){return c(!1)}}),Object(m.a)("div",{className:"settings-wrapper",style:{top:n.current?n.current.getClientRects()[0].bottom:0,right:n.current?document.body.clientWidth-n.current.getClientRects()[0].right:0}},Object(m.a)("button",{className:"cta",onClick:t},"Manage Subscription"),Object(m.a)("button",{className:"cta",onClick:t},"Update Billing Details"),Object(m.a)("button",{className:"cta",onClick:t},"Billing History"))):null)};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S="https://api.kactus.io/v1";var P=function(e){var t=e.memberId,n=e.user,r=e.isAdmin,a=e.orgId,c=e.setBanner,i=e.setUser,l=o.a.useState(null),u=l[0],s=l[1],b=o.a.useState(!1),O=b[0],g=b[1],d=r&&n.githubId!==t,j=o.a.useCallback((function(){g(!0);var e={memberId:t,githubId:n.githubId,githubToken:n.token,orgId:a};fetch(S+"/orgs/member",{body:JSON.stringify(e),mode:"cors",method:"DELETE"}).then((function(e){if(!e.ok)return e.json().then((function(e){throw new Error(e.message)}))})).then((function(){i(N(N({},n),{},{orgs:(n.orgs||[]).map((function(e){return e.id===a?(e.members=(e.members||[]).filter((function(e){return t!==e})),e):e})),currentOrg:N(N({},n.currentOrg),{},{members:(n.currentOrg.members||[]).filter((function(e){return t!==e}))})}))})).catch((function(e){c({message:e.message,error:!0}),g(!1)}))}),[t]);return o.a.useEffect((function(){var e=!1;return fetch("https://api.github.com/user/"+t,{headers:{Authorization:"Token "+localStorage.token,Accept:"application/vnd.github.v3+json"}}).then((function(e){return 200!==e.status?e.json().then((function(e){throw new Error(e)})):e.json()})).then((function(t){e||s(t)})).catch((function(e){return c({message:e.message,error:!0})})),function(){e=!0}}),[t]),Object(m.a)("tr",null,Object(m.a)("td",null,Object(m.a)("div",{className:"avatar"},u&&!O?Object(m.a)("img",{src:u.avatar_url}):null)),Object(m.a)("td",null,u&&!O?u.login:"Loading..."),Object(m.a)("td",null,u&&!O&&d?Object(m.a)("button",{className:"remove-member cta",onClick:j},"Remove"):null))},U=function(e){var t=e.user,n=e.org,r=e.setBanner,a=e.setUser,c=o.a.useState(!1),i=c[0],l=c[1],u=o.a.useState(!1),s=u[0],b=u[1],O=o.a.useState(""),g=O[0],d=O[1],j=!n.valid&&!n.validEnterprise,p=function(e,t){return-1!==t.admins.indexOf(e.githubId)}(t,n),h=o.a.useCallback((function(){b(!0);var e={memberUsername:g.trim().replace(/^@/g,""),githubId:t.githubId,githubToken:t.token,orgId:n.id};fetch(S+"/orgs/member",{body:JSON.stringify(e),mode:"cors",method:"POST"}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw new Error(e.message)}))})).then((function(e){a(N(N({},t),{},{orgs:(t.orgs||[]).map((function(t){return n.id===t.id?(t.members=(t.members||[]).concat(e.memberId),t):t})),currentOrg:N(N({},t.currentOrg),{},{members:(t.currentOrg.members||[]).concat(e.memberId)})})),d("")})).catch((function(e){r({message:e.message,error:!0}),b(!1)}))}),[g,t,n]),y=o.a.useCallback((function(){fetch(S+"/accessStripeDashboard",{body:JSON.stringify({githubId:t.githubId,githubToken:t.token,orgId:n.id}),mode:"cors",method:"POST"}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw new Error(e.message)}))})).then((function(e){var t=e.url;window.location.href=t})).catch((function(e){return r({message:e.message,error:!0})}))}),[t,n]);return i?Object(m.a)(f,{org:n,user:t,setBanner:r,setUser:a}):Object(m.a)("div",{id:"manage-org",style:{position:"relative"}},Object(m.a)("h1",null,"Manage your organization"),j?Object(m.a)("div",null,Object(m.a)("p",null,"Looks like the subscription is not valid anymore."),Object(m.a)("button",{className:"cta primary",onClick:function(){return l(!0)}},"Renew subscription")):Object(m.a)("div",null,n.prepaidFor?null:Object(m.a)(w,{setUser:a,setBanner:r,user:t,org:n,onRedirectToStripeDashboard:y}),Object(m.a)("fieldset",null,Object(m.a)("label",{htmlFor:"github-username"},"Add a member to your organization"),Object(m.a)("input",{type:"text",id:"github-username",placeholder:"GitHub username",value:g,onChange:function(e){return d(e.currentTarget.value)}}),s?"Adding...":Object(m.a)("button",{className:"cta",id:"onAddMember",onClick:h},"Add to organization"))),Object(m.a)("table",null,Object(m.a)("tbody",{id:"org-member"},n.members.map((function(e){return Object(m.a)(P,{setUser:a,setBanner:r,key:e,memberId:e,orgId:n.id,user:t,isAdmin:p})})))))},E=n("OMj+");n("oeLg"),n("OohN"),t.default=function(e){var t=e.location,n=Object(E.a)(t),a=n[0],g=n[1],d=n[2],j=o.a.useState(null),p=j[0],y=j[1];return o.a.useEffect((function(){a||g||(localStorage.signupFromOrg="true",Object(c.navigate)("/login"))}),[g]),Object(m.a)(i.a,null,Object(m.a)(l.a,null),Object(m.a)(u.a,null),g?Object(m.a)(s.a,null):a?Object(m.a)(o.a.Fragment,null,Object(m.a)(O,{setUser:d}),a.currentOrg?Object(m.a)(U,{setUser:d,user:a,org:a.currentOrg,setBanner:y}):a.orgs&&a.orgs.length?Object(m.a)(h,{user:a,setUser:d}):Object(m.a)(f,{setUser:d,user:a,setBanner:y})):null,p?Object(m.a)(b.a,Object(r.a)({},p,{onClose:function(){return y(null)}})):null,Object(m.a)("hr",null),Object(m.a)("script",{src:"https://js.stripe.com/v3/"}))}},CE1Z:function(e,t,n){}}]);
//# sourceMappingURL=component---src-pages-org-tsx-2e0dce8eef838d3a200b.js.map